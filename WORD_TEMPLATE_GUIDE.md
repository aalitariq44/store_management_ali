# دليل إعداد قالب Word للدفعات

## نظرة عامة
تم تطوير نظام طباعة الدفعات ليستخدم قالب Word بدلاً من PDF. عند الضغط على "طباعة الدفعات"، سيقوم النظام بملء قالب Word الموجود في `assets/template/Payments.docx` بالبيانات ثم فتح الملف في Microsoft Word.

## المتغيرات المطلوبة في قالب Word

يجب أن يحتوي قالب Word على المتغيرات التالية:

### بيانات الزبون:
- `{{name_Customer}}` - اسم الزبون
- `{{number_Customer}}` - رقم الزبون
- `{{phone_Customer}}` - رقم هاتف الزبون
- `{{adrees_Customer}}` - عنوان الزبون

### بيانات السلعة:
- `{{name_Item}}` - اسم السلعة
- `{{prace_Item}}` - سعر السلعة
- `{{date_Item}}` - تاريخ الشراء

### جدول الدفعات:
يجب إنشاء جدول باستخدام العلامة `{{#payments_table}}...{{/payments_table}}` مع الأعمدة التالية:
- `{{row_number}}` - رقم الدفعة
- `{{prace}}` - مبلغ الدفعة
- `{{date}}` - تاريخ الدفع
- `{{notes}}` - ملاحظات الدفعة

## مثال على بنية القالب

```
محلات نيويورك

إسم الزبون: {{name_Customer}}
رقم الزبون: {{number_Customer}}
رقم هاتف الزبون: {{phone_Customer}}
عنوان الزبون: {{adrees_Customer}}

إسم السلعة: {{name_Item}}
سعر السلعة: {{prace_Item}}
تاريخ الشراء: {{date_Item}}

| ت | مبلغ الدفعة | تاريخ الدفع | ملاحظات |
|---|------------|------------|---------|
{{#payments_table}}
| {{row_number}} | {{prace}} | {{date}} | {{notes}} |
{{/payments_table}}
```

## كيفية إنشاء القالب

1. افتح Microsoft Word
2. أنشئ مستنداً جديداً
3. قم بتصميم القالب كما تريد
4. أضف المتغيرات في الأماكن المناسبة
5. احفظ الملف باسم `Payments.docx` في مجلد `assets/template/`

## ملاحظات مهمة

1. تأكد من أن قالب Word يحتوي على جميع المتغيرات المطلوبة
2. استخدم التنسيق العربي المناسب
3. يمكنك تخصيص تصميم القالب حسب احتياجاتك
4. تأكد من أن Microsoft Word أو تطبيق متوافق مثبت على النظام

## استكشاف الأخطاء

### إذا لم يتم فتح الملف:
- تأكد من تثبيت Microsoft Word أو تطبيق متوافق
- تحقق من الأذونات للوصول إلى الملفات

### إذا لم تظهر البيانات بشكل صحيح:
- تحقق من أن أسماء المتغيرات في القالب تطابق المتغيرات المذكورة أعلاه
- تأكد من استخدام الأقواس المجعدة المزدوجة `{{}}` بشكل صحيح

### إذا كان هناك مشاكل في الترميز:
- احفظ قالب Word بترميز UTF-8
- تأكد من أن النص العربي يظهر بشكل صحيح في القالب
